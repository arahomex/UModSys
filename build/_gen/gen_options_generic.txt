begin project-group umodsys
  set path-tmp $(path-root)/tmp
  set path-bin $(path-root)/bin
  set path-dep $(path-root)/depends

  set path-include $(path-root)/include
  set path-inc $(path-root)/include/umodsys

  set path-dep-jpeg-inc $(path-dep)/jpeglib
  set path-dep-png-inc $(path-dep)/libpng
  set path-dep-zlib-inc $(path-dep)/zlib
  set path-dep-SDL2-inc $(path-dep)/SDL2/include
  set path-dep-SDL2_ttf-inc $(path-dep)/SDL2_ttf

  set path-src $(path-root)/src
  set path-s-base $(path-src)/base
  set path-s-basesys $(path-src)/basesys
  set path-s-core $(path-src)/core

  set path-s-lib $(path-src)/lib
  set path-s-mod $(path-src)/module
  set path-s-plugin $(path-src)/plugin

  option project-order umodsysc

  begin project all
    mode lib
    #
    depend umodsys_lib_core
    depend umodsys_lib_base
    depend umodsys_lib_basesys
    #
    depend umodsys_lib_libmedia
    depend umodsys_lib_libui
    depend umodsys_lib_lib2d
    depend umodsys_lib_lib3d
    #
    depend umodsysc
    #
    depend plugin_test1
    depend plugin_test2
  end

  begin project umodsysc
    mode binary
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      file $(path-s-basesys)/umodsys.c_main.cpp
    end
    #
    depend umodsys_lib_core
    depend umodsys_lib_base
    depend umodsys_lib_basesys
    #
    depend umodsys_lib_libmedia
    depend umodsys_lib_libui
#    depend umodsys_lib_lib2d
#    depend umodsys_lib_lib3d
  end

  begin project umodsys_lib_core
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      file $(path-s-core)/umodsys.core.objects.cpp
      file $(path-s-core)/umodsys.core.stdtypedefs.cpp
      file $(path-s-core)/umodsys.core.uniqueptr.cpp
      file $(path-s-core)/umodsys.core.uniqueptrlist.cpp
    end
    begin file-group src-tl
      file $(path-s-core)/umodsys.tl.strings.cpp
      file $(path-s-core)/umodsys.tl.utf.cpp
    end
    begin file-group headers
      begin file-group core
        begin mask $(path-skip) $(path-inc)/core
          include *.h
        end
        begin file-group arch
          begin mask $(path-skip) $(path-inc)/core/arch
            include *.h
          end
        end
        begin file-group mem
          begin mask $(path-skip) $(path-inc)/core/mem
            include *.h
          end
        end
        begin file-group util
          begin mask $(path-skip) $(path-inc)/core/util
            include *.h
          end
        end
      end
      #
      begin file-group tl
        begin file-group composite
          begin mask $(path-skip) $(path-inc)/tl/composite
            include *.h
          end
        end
        begin file-group alloc
          begin mask $(path-skip) $(path-inc)/tl/alloc
            include *.h
          end
        end
        begin file-group math
          begin mask $(path-skip) $(path-inc)/tl/math
            include *.h
          end
        end
        begin file-group metastl
          begin mask $(path-skip) $(path-inc)/tl/metastl
            include *.h
          end
        end
        begin file-group string
          begin mask $(path-skip) $(path-inc)/tl/string
            include *.h
          end
        end
        begin file-group util
          begin mask $(path-skip) $(path-inc)/tl/util
            include *.h
          end
        end
      end
    end
  end

  begin project umodsys_lib_basesys
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      begin mask $(path-skip) $(path-s-basesys)
        include *.cpp
        include *.h
      end
    end
  end

  begin project umodsys_lib_base
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      begin mask $(path-skip) $(path-s-base)
        include *.cpp
        include *.h
      end
    end
    begin file-group headers
      begin file-group base
        begin mask $(path-skip) $(path-inc)/base
          include *.h
        end
      end
    end
  end

  begin project umodsys_lib_libmedia
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    includes $(path-dep-jpeg-inc)
    includes $(path-dep-png-inc)
    includes $(path-dep-zlib-inc)
    #
    begin file-group headers_media
      begin mask $(path-skip) $(path-inc)/lib/media
        include *.h
      end
    end
    begin file-group lib_media
      begin mask $(path-skip) $(path-s-lib)/media
        include *.cpp *.h 
      end
    end
    begin file-group mod_stdio
      begin mask $(path-skip) $(path-s-mod)/media/stdio
        include *.cpp *.h 
      end
    end
    begin file-group mod_std
      begin mask $(path-skip) $(path-s-mod)/media/std
        include *.cpp *.h 
      end
    end
    begin file-group mod_images_std
      begin mask $(path-skip) $(path-s-mod)/media/images_std
        include *.cpp *.h 
      end
    end
  end

  begin project umodsys_lib_libui
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    includes $(path-dep-SDL2-inc)
    includes $(path-dep-SDL2_ttf-inc)
    #
    begin file-group headers_ui
      begin mask $(path-skip) $(path-inc)/lib/ui
        include *.h
      end
    end
    begin file-group lib_ui
      begin mask $(path-skip) $(path-s-lib)/ui
        include *.cpp *.h 
      end
    end
    begin file-group mod_SDL_core
      begin mask $(path-skip) $(path-s-mod)/ui/SDL_core
        include *.cpp *.h 
      end
    end
    begin file-group mod_frames
      begin mask $(path-skip) $(path-s-mod)/ui/frames
        include *.cpp *.h 
      end
    end
  end

  begin project umodsys_lib_lib2d
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group headers_2d
      begin mask $(path-skip) $(path-inc)/lib/2d
        include *.h
      end
    end
    begin file-group lib_2d
      begin mask $(path-skip) $(path-s-lib)/2d
        include *.cpp *.h 
      end
    end
    begin file-group mod_stdlib
      begin mask $(path-skip) $(path-s-mod)/2d/stdlib
        include *.cpp *.h 
      end
    end
  end

  begin project umodsys_lib_lib3d
    mode lib
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group headers_3d
      begin mask $(path-skip) $(path-inc)/lib/3d
        include *.h
      end
    end
    begin file-group lib_3d
      begin mask $(path-skip) $(path-s-lib)/3d
        include *.cpp *.h 
      end
    end
  end

  begin project plugin_test1
    mode shared
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      begin mask $(path-skip) $(path-s-plugin)/test
        include plugin_test1.cpp
        include plugin_test1.*.h
      end
    end
    depend umodsys_lib_core
    depend umodsys_lib_base
    #
    depend umodsys_lib_libmedia
    depend umodsys_lib_libui
    depend umodsys_lib_lib2d
    depend umodsys_lib_lib3d
  end

  begin project plugin_test2
    mode shared
    #
    includes $(path-include)
    includes $(path-include)/$(ppath)
    #
    begin file-group src
      begin mask $(path-skip) $(path-s-plugin)/test
        include plugin_test2.cpp
        include plugin_test2.*.h
      end
    end
    depend umodsys_lib_core
    depend umodsys_lib_base
  end

end
